<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anton Zaratustra</title>
    <style>
        :root {
            --bg-dark: #0a0a0f;
            --bg-light: #f0f0f5;
            --fg-dark: #0a0a0f;
            --fg-light: #f0f0f5;
            --color-background: #0a0a0f;
            --color-background-secondary: #1a1a2e;
            --color-text-default: #e6e6f0;
        }
        * { box-sizing: border-box; }
        html, body {
            margin: 0;
            height: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        
        /* Light theme */
        html.light {
            --color-background: #f0f0f5;
            --color-background-secondary: #d0d0e0;
            --color-text-default: #333333;
        }
        
        /* Dark theme */
        html.dark {
            --color-background: #0a0a0f;
            --color-background-secondary: #1a1a2e;
            --color-text-default: #e6e6f0;
        }
        
        body {
            background-color: var(--color-background);
            color: var(--fg-dark);
        }
        
        #wrap { position: fixed; inset: 0; display: grid; grid-template-rows: auto 1fr; }
        header {
            padding: 10px 14px;
            display: flex;
            gap: 14px;
            align-items: center;
            background: linear-gradient(to bottom, rgba(255,255,255,0.04), rgba(0,0,0,0));
            backdrop-filter: blur(6px);
            -webkit-backdrop-filter: blur(6px);
            z-index: 2;
        }
        header h1 { margin: 0; font-size: 14px; font-weight: 600; letter-spacing: .08em; text-transform: uppercase; opacity: .8; }
        #c { width: 100vw; height: 100vh; display: block; }
        
        /* Added styles for theme and language toggle */
        .top-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        
        /* ThemeToggle */
        .ThemeToggle {
            appearance: none;
            width: 62px;
            height: 32px;
            display: inline-block;
            position: relative;
            border-radius: 50px;
            overflow: hidden;
            outline: none;
            border: none;
            cursor: pointer;
            background: var(--color-background-secondary);
            transition: background-color ease 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .ThemeToggle::before {
            content: "üåô";
            display: block;
            position: absolute;
            z-index: 2;
            width: 24px;
            height: 24px;
            background: var(--color-background);
            left: 4px;
            top: 4px;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            font-size: 14px;
            transition: all cubic-bezier(0.3, 1.5, 0.7, 1) 0.3s;
        }

        .ThemeToggle:checked {
            background-color: var(--color-background-secondary);
            border-color: var(--color-background);
        }

        .ThemeToggle:checked::before {
            left: 32px;
            content: "‚òÄÔ∏è";
            background: var(--color-background);
        }
        
        /* Language Toggle */
        .LanguageToggle {
            appearance: none;
            width: 62px;
            height: 32px;
            display: inline-block;
            position: relative;
            border-radius: 50px;
            overflow: hidden;
            outline: none;
            border: none;
            cursor: pointer;
            background: #FFA500; /* Orange background */
            transition: background-color ease 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            color: #333; /* Dark text for better contrast */
            font-weight: bold;
            text-transform: uppercase;
        }

        .LanguageToggle::before {
            content: "EN";
            display: block;
            position: absolute;
            z-index: 2;
            width: 24px;
            height: 24px;
            background: white;
            left: 4px;
            top: 4px;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            font-size: 12px;
            color: #333; /* Dark text for better contrast */
            transition: all cubic-bezier(0.3, 1.5, 0.7, 1) 0.3s;
        }

        .LanguageToggle:checked {
            background-color: #FFA500; /* Orange background */
        }

        .LanguageToggle:checked::before {
            left: 32px;
            content: "RU";
            background: white;
            color: #333; /* Dark text for better contrast */
        }
        
        /* Center content styles - no background layer */
        .center-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 5;
            padding: 20px;
            width: 90%;
            max-width: 800px;
        }
        
        /* Hide the matrix subtitle */
        .matrix-text {
            display: none;
        }
        
        /* Custom heading for Zaratustra in 3x3 grid */
        .custom-heading {
            display: grid;
            grid-template-columns: repeat(3, 150px);
            grid-template-rows: repeat(3, 150px);
            gap: 0;
            width: 450px;
            height: 450px;
            margin: 0 auto 20px;
            font-size: 4.5rem;
            font-weight: 700;
            letter-spacing: -0.03em;
            position: relative;
        }
        
        /* Square border - centered on the T letter (center of grid) */
        .square-border {
            position: absolute;
            width: 450px;
            height: 450px;
            border: 21px solid var(--fg-dark);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1;
        }
        
        .custom-heading .letter {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            z-index: 3;
        }
        
        .custom-heading .out-of-box {
            position: absolute;
            left: 510px;
            top: 330px;
        }
        
        /* Logo styling - 3x larger */
        .center-logo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            width: 650px; /* 3x larger than previous 200px */
            height: auto;
            pointer-events: none;
        }
        
        .center-content h1 {
            margin: 0 0 20px 0;
            font-size: 6rem;
            font-weight: 700;
            letter-spacing: -0.03em;
        }
        
        .center-content .matrix-text {
            margin: 0;
            font-size: 6rem;
            font-weight: 700;
            letter-spacing: -0.03em;
        }
        
        /* Theme-specific text colors - matching background color */
        body.dark-theme .center-content h1,
        body.dark-theme .center-content .matrix-text {
            color: var(--fg-dark);
        }
        
        body.light-theme .center-content h1,
        body.light-theme .center-content .matrix-text {
            color: var(--fg-light);
        }
        
        /* Responsive font sizes */
        @media (max-width: 768px) {
            .center-content h1,
            .center-content .matrix-text {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body class="dark">
    <div id="wrap">
        <canvas id="c"></canvas>
    </div>
    
    <!-- Top controls for theme and language toggle -->
    <div class="top-controls">
        <input id="themeSwitcher" class="ThemeToggle" type="checkbox">
        <input id="languageSwitcher" class="LanguageToggle" type="checkbox">
    </div>
    
    <!-- Center content - no background layer -->
    <div class="center-content">
        <div class="custom-heading">
            <div class="letter">Z</div>
            <div class="letter">A</div>
            <div class="letter">R</div>
            <div class="letter">A</div>
            <div class="letter">T</div>
            <div class="letter">U</div>
            <div class="letter">S</div>
            <div class="letter">T</div>
            <div class="letter">R</div>
            <div class="letter out-of-box">A</div>
            <div class="square-border"></div>
            <img src="imgs/logo-transparent.png" alt="Logo" class="center-logo">
        </div>
        <div class="matrix-text" data-en="Matrix has you..." data-ru="–¢—ã —É–≤—è–∑ –≤ –º–∞—Ç—Ä–∏—Ü–µ...">Matrix has you...</div>
    </div>

    <script>
        // Theme and language toggle functionality
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggle = document.getElementById('themeSwitcher');
            const languageToggle = document.getElementById('languageSwitcher');
            const body = document.body;
            let isDarkTheme = true;
            let currentLang = 'en';

            // Function to switch language
            function switchLanguage(lang) {
                currentLang = lang;
                document.querySelectorAll('[data-en], [data-ru]').forEach(function(el) {
                    el.textContent = el.dataset[lang];
                });
            }

            // Function to toggle theme
            function toggleTheme() {
                if (isDarkTheme) {
                    body.classList.remove('dark');
                    body.classList.add('light');
                    document.documentElement.classList.remove('dark');
                    document.documentElement.classList.add('light');
                } else {
                    body.classList.remove('light');
                    body.classList.add('dark');
                    document.documentElement.classList.remove('light');
                    document.documentElement.classList.add('dark');
                }
                isDarkTheme = !isDarkTheme;
            }

            themeToggle.addEventListener('change', toggleTheme);

            languageToggle.addEventListener('change', function() {
                switchLanguage(currentLang === 'en' ? 'ru' : 'en');
            });

            // Initial language setup
            switchLanguage('en');
        });

        // ASCII Phoenix animation code
        (() => {
            const canvas = document.getElementById('c');
            const ctx = canvas.getContext('2d');
            const body = document.body;
            let paused = false;

            const RAMP = ' .,:;i1tfLC08@#'; // ASCII —Å–∏–º–≤–æ–ª—ã
            let charW = 10, charH = 14, cols = 0, rows = 0;
            let t0 = performance.now();
            let loopLen = 9000;
            let baseHue = 18, hueShift = 0, speedMul = 1.0;

            let field, nextField, phoenixMask, phoenixDetailMask;
            const DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));

            // Function to get current theme colors
            function getThemeColors() {
                if (body.classList.contains('light')) {
                    return {
                        bg: '#f0f0f5',
                        fg: '#f0f0f5'
                    };
                } else {
                    return {
                        bg: '#0a0a0f',
                        fg: '#0a0a0f'
                    };
                }
            }

            function resize() {
                canvas.width = Math.floor(window.innerWidth * DPR);
                canvas.height = Math.floor(window.innerHeight * DPR);
                charW = 10 * DPR;
                charH = Math.floor(charW * 1.35);
                cols = Math.floor(canvas.width / charW);
                rows = Math.floor(canvas.height / charH);
                field = new Float32Array(cols * rows).fill(0);
                nextField = new Float32Array(cols * rows).fill(0);
                phoenixMask = new Float32Array(cols * rows).fill(0);
                phoenixDetailMask = new Float32Array(cols * rows).fill(0);
                buildPhoenixMask();
            }
            
            function idx(x,y){ return y*cols + x; }
            
            function hash(x, y) {
                let n = x * 374761393 + y * 668265263;
                n = (n ^ (n >> 13)) * 1274126177;
                return ((n ^ (n >> 16)) >>> 0) / 4294967295;
            }
            
            function smoothNoise(x, y) {
                const xi = Math.floor(x), yi = Math.floor(y);
                const xf = x - xi, yf = y - yi;
                const n00 = hash(xi, yi), n10 = hash(xi+1, yi);
                const n01 = hash(xi, yi+1), n11 = hash(xi+1, yi+1);
                const sx = xf*xf*(3-2*xf), sy = yf*yf*(3-2*yf);
                const nx0 = n00*(1-sx) + n10*sx;
                const nx1 = n01*(1-sx) + n11*sx;
                return nx0*(1-sy) + nx1*sy;
            }
            
            function fbm(x, y, oct=4) {
                let a=0, amp=0.5, freq=1.0;
                for (let i=0;i<oct;i++) {
                    a += smoothNoise(x*freq, y*freq) * amp;
                    freq *= 2.01; amp *= 0.55;
                }
                return a;
            }
            
            function buildPhoenixMask() {
                phoenixMask.fill(0);
                phoenixDetailMask.fill(0);
                const cx = cols/2, cy = rows*0.62;
                const scale = Math.min(cols, rows) * 0.45;
                for (let y=0; y<rows; y++) {
                    for (let x=0; x<cols; x++) {
                        const nx = (x - cx) / scale;
                        const ny = (y - cy) / scale;
                        const r = Math.hypot(nx*0.9, ny*1.2);
                        const body = Math.max(0, 1 - r*r*1.8 - (ny*0.6+0.15));
                        const wingL = Math.max(0, 1 - (Math.hypot((nx+0.9)*1.1, (ny+0.05)*1.9)*1.6));
                        const wingR = Math.max(0, 1 - (Math.hypot((nx-0.9)*1.1, (ny+0.05)*1.9)*1.6));
                        const tail = Math.max(0, 1 - Math.hypot(nx*0.7, (ny-0.7)*2.2)*1.8);
                        const head = Math.max(0, 1 - Math.hypot((nx)*2.0, (ny+0.25)*3.4)*2.2);
                        const beak = Math.max(0, 1 - Math.hypot((nx-0.18)*8.5, (ny+0.23)*10.0)*1.3);
                        let m = Math.max(body*1.05, wingL*0.95, wingR*0.95, tail*0.8, head*1.1, beak*0.8);
                        m = Math.min(1, Math.max(0, m));
                        const d = Math.pow(fbm(nx*3+5.4, ny*3-2.7, 3), 1.6);
                        const feather = m * (0.35 + 0.65*d);
                        phoenixMask[idx(x,y)] = m;
                        phoenixDetailMask[idx(x,y)] = feather;
                    }
                }
            }
            
            // New function to create flame tongue effect
            function createFlameEffect(time) {
                const t = time * 0.001;
                const flameMask = new Float32Array(cols * rows).fill(0);
                const cx = cols/2, cy = rows*0.75; // Flame origin at bottom center
                
                for (let y=0; y<rows; y++) {
                    for (let x=0; x<cols; x++) {
                        // Distance from bottom center
                        const dx = x - cx;
                        const dy = y - cy;
                        const distance = Math.sqrt(dx*dx + dy*dy);
                        
                        // Create multiple flame tongues with random offsets
                        let flameIntensity = 0;
                        
                        // Main central flame
                        const angle = Math.atan2(dy, dx);
                        const wave = Math.sin(angle * 3 + t * 2) * 0.3;
                        const flameShape = Math.max(0, 1 - (distance / (rows * 0.4)) + wave);
                        flameIntensity = Math.max(flameIntensity, flameShape * 0.8);
                        
                        // Secondary flames
                        for (let i = 0; i < 5; i++) {
                            const offsetX = Math.sin(t * 0.5 + i) * 20;
                            const offsetY = Math.cos(t * 0.7 + i) * 10;
                            const dx2 = x - (cx + offsetX);
                            const dy2 = y - (cy + offsetY);
                            const dist2 = Math.sqrt(dx2*dx2 + dy2*dy2);
                            const angle2 = Math.atan2(dy2, dx2);
                            const wave2 = Math.sin(angle2 * 2 + t * 3 + i) * 0.2;
                            const flameShape2 = Math.max(0, 1 - (dist2 / (rows * 0.3)) + wave2);
                            flameIntensity = Math.max(flameIntensity, flameShape2 * 0.6);
                        }
                        
                        flameMask[idx(x,y)] = Math.min(1, flameIntensity);
                    }
                }
                return flameMask;
            }
            
            // Function to interpolate between two colors
            function interpolateColor(color1, color2, factor) {
                const result = [];
                for (let i = 0; i < 3; i++) {
                    result.push(Math.round(color1[i] + (color2[i] - color1[i]) * factor));
                }
                return result;
            }
            
            // Function to get a random flame color from our extended palette
            function getRandomFlameColor() {
                // Extended flame color palette with more vibrant colors
                const flameColors = [
                    [255, 255, 204],  // Light Yellow (#FFFFCC)
                    [255, 242, 153],  // Yellow (#FFF299)
                    [255, 229, 102],  // Golden Yellow (#FFE566)
                    [255, 215, 0],    // Yellow (#FFD700)
                    [255, 204, 0],    // Yellow-Orange (#FFCC00)
                    [255, 191, 0],    // Golden (#FFBF00)
                    [255, 178, 0],    // Orange-Yellow (#FFB200)
                    [255, 165, 0],    // Orange (#FFA500)
                    [255, 153, 0],    // Slightly Darker Orange (#FF9900)
                    [255, 140, 0],    // Dark Orange (#FF8C00)
                    [255, 128, 0],    // Bright Orange (#FF8000)
                    [255, 115, 0],    // Deep Orange (#FF7300)
                    [255, 102, 0],    // Vibrant Orange (#FF6600)
                    [255, 90, 0],     // Bright Red-Orange (#FF5A00)
                    [255, 77, 0],     // Intense Orange (#FF4D00)
                    [255, 64, 0]      // Deep Red-Orange (#FF4000)
                ];
                
                // Return a random color from our palette
                const randomIndex = Math.floor(Math.random() * flameColors.length);
                return flameColors[randomIndex];
            }
            
            // Function to get flame color based on value (intensity) with smoother transitions
            function getFlameColorByValue(v) {
                // Extended flame color palette with more vibrant colors
                const flameColors = [
                    [255, 255, 204],  // Light Yellow (#FFFFCC)
                    [255, 242, 153],  // Yellow (#FFF299)
                    [255, 229, 102],  // Golden Yellow (#FFE566)
                    [255, 215, 0],    // Yellow (#FFD700)
                    [255, 204, 0],    // Yellow-Orange (#FFCC00)
                    [255, 191, 0],    // Golden (#FFBF00)
                    [255, 178, 0],    // Orange-Yellow (#FFB200)
                    [255, 165, 0],    // Orange (#FFA500)
                    [255, 153, 0],    // Slightly Darker Orange (#FF9900)
                    [255, 140, 0],    // Dark Orange (#FF8C00)
                    [255, 128, 0],    // Bright Orange (#FF8000)
                    [255, 115, 0],    // Deep Orange (#FF7300)
                    [255, 102, 0],    // Vibrant Orange (#FF6600)
                    [255, 90, 0],     // Bright Red-Orange (#FF5A00)
                    [255, 77, 0],     // Intense Orange (#FF4D00)
                    [255, 64, 0]      // Deep Red-Orange (#FF4000)
                ];
                
                // Map the value (0-1) to a position in our extended flame gradient
                const index = Math.min(flameColors.length - 1, Math.floor(v * flameColors.length));
                return flameColors[index];
            }
            
            function draw(time) {
                if (paused) { requestAnimationFrame(draw); return; }
                
                // Get current theme colors
                const colors = getThemeColors();
                
                const t = (time - t0) * speedMul;
                const phase = (t % loopLen) / loopLen;
                
                // Create flame effect instead of phoenix
                const flameMask = createFlameEffect(t);
                
                // Apply noise to flame for more realistic movement
                for (let x=0; x<cols; x++) {
                    const n = fbm(x*0.07, t*0.0009, 3);
                    field[idx(x, rows-1)] = 0.6 + 0.4*n;
                }
                for (let y=0; y<rows-1; y++) {
                    for (let x=0; x<cols; x++) {
                        const j = Math.floor((smoothNoise(x*0.17, (t*0.001 + y*0.05))*2-1)*2);
                        const sx = Math.min(cols-1, Math.max(0, x + j));
                        const sy = Math.min(rows-1, y+1);
                        const v = field[idx(sx, sy)];
                        const l = field[idx(Math.max(0,x-1), sy)];
                        const r = field[idx(Math.min(cols-1,x+1), sy)];
                        nextField[idx(x,y)] = (v*2 + l + r) * 0.25 * 0.98;
                    }
                }
                [field, nextField] = [nextField, field];
                
                // Apply flame mask to field
                for (let y=0; y<rows; y++) {
                    for (let x=0; x<cols; x++) {
                        const flameIntensity = flameMask[idx(x,y)];
                        field[idx(x,y)] = Math.min(1, field[idx(x,y)] + flameIntensity * 0.7);
                    }
                }
                
                // Clear canvas with theme background color
                ctx.fillStyle = colors.bg;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.save();
                ctx.translate((canvas.width - cols*charW)/2, (canvas.height - rows*charH)/2);
                ctx.font = `${Math.floor(charH*0.95)}px monospace`;
                ctx.textBaseline = 'top';
                for (let y=0; y<rows; y++) {
                    for (let x=0; x<cols; x++) {
                        const v = field[idx(x,y)];
                        const rampIndex = Math.min(RAMP.length-1, Math.max(0, Math.floor(v * (RAMP.length-1))));
                        const ch = RAMP[rampIndex];
                        if (ch === ' ') continue;
                        
                        // Use flame colors instead of the original HSV-based coloring
                        const [r, g, b] = getFlameColorByValue(v);
                        ctx.fillStyle = `rgba(${r},${g},${b},${0.85})`;
                        ctx.fillText(ch, x*charW, y*charH);
                    }
                }
                ctx.restore();
                requestAnimationFrame(draw);
            }
            
            // Watch for theme changes
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        // Redraw with new theme colors
                        // The draw function will automatically pick up the new colors
                    }
                });
            });
            
            observer.observe(body, { attributes: true });
            
            window.addEventListener('resize', resize, {passive:true});
            resize();
            requestAnimationFrame(draw);
        })();
    </script>
</body>
</html>